import{r as a,E,s as T,b as h,j as e}from"./index-Bf0_iwmC.js";import{R as Q}from"./quill.snow-N0L4fiYi.js";const R=()=>{const[p,m]=a.useState(""),[b,x]=a.useState(""),[r,f]=a.useState([]),{id:d}=E(),[j,N]=a.useState([]),[i,g]=a.useState([]),[c,u]=a.useState([]),w=T();a.useEffect(()=>{C()},[]);const y={toolbar:[[{font:[]}],["bold","italic","underline","strike","blockquote"],[{header:[1,2,3,4,5,6,!1]}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],["link","image","video"],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],clipboard:{matchVisual:!1}},C=async()=>{try{const t=(await h.get(`/api/qualitycontrol/getQualityControlById?id=${d}`,{withCredentials:!0})).data.data;m(t.title),x(t.description),N(t.photo),u(t.alt)}catch(s){console.error(s)}},P=async s=>{s.preventDefault();try{const t=new FormData;t.append("title",p),t.append("description",b);const l=[...c,...i];r.forEach(n=>{t.append("photo",n)}),l.forEach(n=>{t.append("alt",n)});const o=await h.put(`/api/qualitycontrol/updateQualityControl?id=${d}`,t,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});w("/qualitycontrol")}catch(t){console.error(t)}},A=s=>{const t=Array.from(s.target.files);f([...r,...t])},k=(s,t)=>{const l=[...c];l[t]=s.target.value,u(l)},$=(s,t)=>{const l=[...i];l[t]=s.target.value,g(l)},q=(s,t,l)=>{s.preventDefault(),h.delete(`/api/qualitycontrol/${d}/image/${t}/${l}`,{withCredentials:!0}).then(o=>{const n=j.filter(S=>S!==t);N(n);const v=[...c];v.splice(l,1),u(v)}).catch(o=>{console.error(o)})},D=(s,t)=>{s.preventDefault();const l=[...r];l.splice(t,1),f(l);const o=[...i];o.splice(t,1),g(o)};return e.jsxs("form",{onSubmit:P,className:"p-4",children:[e.jsx("h1",{className:"text-xl font-bold font-serif text-gray-700 uppercase text-center",children:"Edit Quality Control"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block font-semibold mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:p,onChange:s=>m(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"block font-semibold mb-2",children:"Description"}),e.jsx(Q,{value:b,onChange:x,modules:y,className:"quill"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Current Photos"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:j.map((s,t)=>e.jsxs("div",{className:"relative w-56",children:[e.jsx("img",{src:`/api/qualitycontrol/download/${s}`,alt:`Photo ${t+1}`,className:"w-56 h-32 object-cover"}),e.jsxs("label",{htmlFor:`alt-${t}`,className:"block mt-2",children:["Alternative Text:",e.jsx("input",{type:"text",id:`alt-${t}`,value:c[t],onChange:l=>k(l,t),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsx("button",{onClick:l=>q(l,s,t),className:"absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex justify-center items-center",children:e.jsx("span",{className:"text-xs",children:"X"})})]},t))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Add New Photos"}),e.jsx("input",{type:"file",onChange:A,multiple:!0,accept:"image/*",className:"p-2 border rounded"}),e.jsx("div",{className:"flex flex-wrap gap-4 mt-4",children:r.map((s,t)=>e.jsxs("div",{className:"relative w-56",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:`New Photo ${t+1}`,className:"w-56 h-32 object-cover"}),e.jsxs("label",{htmlFor:`alt-new-${t}`,className:"block mt-2",children:["Alternative Text:",e.jsx("input",{type:"text",id:`alt-new-${t}`,value:i[t]||"",onChange:l=>$(l,t),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsx("button",{onClick:l=>D(l,t),className:`absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex\r
                justify-center items-center`,children:e.jsx("span",{className:"text-xs",children:"X"})})]},t))})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none",children:"Save Changes"})})]})};export{R as default};
