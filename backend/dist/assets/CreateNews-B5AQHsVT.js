import{r as s,s as be,b as J,j as e}from"./index-Bf0_iwmC.js";import{R as he}from"./quill.snow-N0L4fiYi.js";import{Q as pe,B as ge}from"./ReactToastify-C8h-yn_H.js";import"./clsx-B-dksMZM.js";const ye=()=>{const[i,v]=s.useState(""),[y,N]=s.useState(""),[c,x]=s.useState([]),[d,u]=s.useState([]),[C,w]=s.useState(""),[S,k]=s.useState("active"),[n,m]=s.useState(""),[F,M]=s.useState(""),[P,q]=s.useState(""),[I,A]=s.useState(""),[D,_]=s.useState(""),[B,E]=s.useState(""),[R,L]=s.useState(""),[T,O]=s.useState(""),[Z,U]=s.useState(""),[Q,Y]=s.useState(""),[$,z]=s.useState(""),[H,K]=s.useState(""),[f,ee]=s.useState([]),[r,V]=s.useState(""),[b,j]=s.useState(""),[W,h]=s.useState(""),te=be();s.useEffect(()=>{ae()},[]);const ae=async()=>{try{const t=await J.get("/api/news/getall",{withCredentials:!0});ee(t.data)}catch(t){console.error(t)}},se=t=>{const a=Array.from(t.target.files);if(c.length+a.length>5){ge.error("You can only upload up to 5 photos");return}x([...c,...a]);const l=Array.from({length:a.length},()=>"");u([...d,...l])},le=t=>{x(a=>a.filter((l,o)=>o!==t)),u(a=>a.filter((l,o)=>o!==t))},oe=async t=>{t.preventDefault();try{const a=new FormData;a.append("title",i),a.append("details",y),a.append("slug",n),a.append("metatitle",F),a.append("metakeywords",I),a.append("metadescription",P),a.append("metalanguage",D),a.append("metacanonical",B),a.append("metaschema",R),a.append("otherMeta",T),a.append("url",Z),a.append("priority",Q),a.append("changeFreq",$),c.forEach((o,g)=>{a.append("photo",o),a.append("alt",d[g])}),a.append("postedBy",H),a.append("date",C),a.append("status",S),a.append("categories",r),a.append("subcategories",b),a.append("subSubcategories",W);const l=await J.post("/api/news/insertNews",a,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});v(""),N(""),x([]),K(""),w(""),m(""),M(""),q(""),A(""),_(""),E(""),L(""),O(""),U(""),Y(""),z(""),k("active"),V(""),j(""),h(""),u([]),te("/News")}catch(a){console.error(a)}},ne=t=>e.jsx("option",{value:t._id,children:t.category},t._id),re=t=>{const a=t.target.value;V(a),j(""),h("")},ce=t=>{const a=t.target.value;j(a),h("")},ie=t=>{const a=t.target.value;h(a)},p=(t,a)=>{for(const l of t){if(l._id===a)return l;if(l.subCategories){const o=p(l.subCategories,a);if(o)return o}}return null},de=(t,a)=>{const l=p(t,a);return l?l.subCategories||[]:[]},ue=(t,a,l)=>{const o=p(t,a);if(o&&o.subCategories){const g=p(o.subCategories,l);return g?g.subSubCategory||[]:[]}return[]},X=r?de(f,r):[],G=r&&b?ue(f,r,b):[],me={toolbar:[[{font:[]}],["bold","italic","underline","strike","blockquote"],[{header:[1,2,3,4,5,6,!1]}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],["link","image","video"],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],clipboard:{matchVisual:!1}};return s.useEffect(()=>{n&&U(`http://localhost:3000/news/${n}`)},[n]),s.useEffect(()=>{m(i)},[i]),s.useEffect(()=>{m(n.replace(/\s+/g,"-").toLowerCase())},[n]),e.jsxs("form",{onSubmit:oe,className:"p-4",children:[e.jsx(pe,{}),e.jsx("h1",{className:"text-xl font-bold font-serif text-gray-700 uppercase text-center",children:"Add News"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"parentCategory",className:"block font-semibold mb-2",children:"Parent Category"}),e.jsxs("select",{id:"parentCategory",value:r,onChange:re,className:"w-full p-2 border rounded focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Parent Category"}),f.map(ne)]})]}),X.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"subCategory",className:"block font-semibold mb-2",children:"Subcategory (optional)"}),e.jsxs("select",{id:"subCategory",value:b,onChange:ce,className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Subcategory"}),X.map(t=>e.jsx("option",{value:t._id,children:t.category},t._id))]})]}),G.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"subSubCategory",className:"block font-semibold mb-2",children:"Sub-Subcategory (optional)"}),e.jsxs("select",{id:"subSubCategory",value:W,onChange:ie,className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{children:"Select Sub-Subcategory"}),G.map(t=>e.jsx("option",{value:t._id,children:t.category},t._id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block font-semibold mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",value:i,onChange:t=>v(t.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{htmlFor:"details",className:"block font-semibold mb-2",children:"Description"}),e.jsx(he,{value:y,onChange:N,modules:me,className:"quill"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"photo",className:"block font-semibold mb-2",children:"Photos"}),e.jsx("input",{type:"file",name:"photo",id:"photo",multiple:!0,onChange:se,className:"border rounded focus:outline-none",accept:"image/*"}),c.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-4",children:c.map((t,a)=>e.jsxs("div",{className:"relative w-56",children:[e.jsx("button",{type:"button",className:"absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex items-center justify-center hover:bg-red-600 focus:outline-none",onClick:()=>le(a),children:"X"}),e.jsx("img",{src:URL.createObjectURL(t),alt:"",className:" h-32 w-56 object-cover"}),e.jsxs("label",{children:["Alternative Text :",e.jsx("input",{type:"text",value:d[a],onChange:l=>{const o=[...d];o[a]=l.target.value,u(o)},className:"w-full p-2 mt-2 border rounded focus:outline-none"})]})]},a))})]}),e.jsxs("div",{className:"mb-4 mt-4",children:[e.jsx("label",{htmlFor:"postedBy",className:"block font-semibold mb-2",children:"Posted By:"}),e.jsx("input",{type:"text",id:"postedBy",value:H,onChange:t=>K(t.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"date",className:"block font-semibold mb-2",children:"Date"}),e.jsx("input",{type:"date",id:"date",value:C,onChange:t=>w(t.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4 mt-4",children:[e.jsx("label",{htmlFor:"slug",className:"block font-semibold mb-2",children:"Slug"}),e.jsx("input",{type:"text",id:"slug",value:n,onChange:t=>m(t.target.value),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"url",className:"block font-semibold mb-2",children:"URL"}),e.jsx("input",{disabled:!0,type:"url",id:"url",value:`http://localhost:3000/news/${n}`,className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Title"}),e.jsx("textarea",{id:"meta",value:F,onChange:t=>M(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Description"}),e.jsx("textarea",{id:"meta",value:P,onChange:t=>q(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Keywords"}),e.jsx("textarea",{id:"meta",value:I,onChange:t=>A(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Canonical"}),e.jsx("textarea",{id:"meta",value:B,onChange:t=>E(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Meta Language"}),e.jsx("textarea",{id:"meta",value:D,onChange:t=>_(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Other Meta"}),e.jsx("textarea",{id:"meta",value:T,onChange:t=>O(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"meta",className:"block font-semibold mb-2",children:"Schema"}),e.jsx("textarea",{id:"meta",value:R,onChange:t=>L(t.target.value),className:"w-full p-2 border rounded focus:outline-none",rows:"3"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"priority",className:"block font-semibold mb-2",children:"Priority"}),e.jsx("input",{type:"number",id:"priority",min:0,max:1,value:Q,onChange:t=>Y(t.target.value),className:"w-full p-2 border rounded focus:outline-none"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"changeFreq",className:"block font-semibold mb-2",children:"Change Frequency"}),e.jsxs("select",{id:"changeFreq",value:$,onChange:t=>z(t.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Change Frequency"}),e.jsx("option",{value:"always",children:"Always"}),e.jsx("option",{value:"hourly",children:"Hourly"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"status",className:"block font-semibold mb-2",children:"Status"}),e.jsxs("select",{id:"status",value:S,onChange:t=>k(t.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white py-2 px-4 rounded",children:"Add News"})]})};export{ye as default};
