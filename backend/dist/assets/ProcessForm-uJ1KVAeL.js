import{E as P,s as T,a7 as F,a8 as L,a9 as S,r as d,j as e}from"./index-Bf0_iwmC.js";import{u as k}from"./index.esm-B8u4eqX5.js";import{R as E}from"./quill.snow-N0L4fiYi.js";const M=()=>{const{id:r}=P(),b=T(),{data:i,isLoading:f,error:u}=F(r,{skip:!r,refetchOnMountOrArgChange:!0}),{register:o,handleSubmit:N,setValue:m,formState:{errors:a}}=k(),[j,{isLoading:n}]=L(),[w,{isLoading:c}]=S(),[p,g]=d.useState(""),[l,x]=d.useState(null);d.useEffect(()=>{if(i!=null&&i.data){const t=i.data;m("title",t.title),g(t.description||""),m("imgTitle",t.imgTitle),m("altName",t.altName),t.photo&&x(`/api/image/download/${t.photo}`)}},[i,m]),d.useEffect(()=>()=>{l&&URL.revokeObjectURL(l)},[l]);const y=async t=>{var h;const s=new FormData;s.append("title",t.title),s.append("description",p),s.append("imgTitle",t.imgTitle),s.append("altName",t.altName),(h=t.photo)!=null&&h[0]&&s.append("photo",t.photo[0]);try{r?await w({id:r,formData:s}).unwrap():await j(s).unwrap(),b("/process-table")}catch(v){console.error("Submission failed:",v)}};return f?e.jsx("div",{children:"Loading process..."}):u?e.jsxs("div",{children:["Error loading process: ",u.message]}):e.jsxs("div",{className:"p-6 max-w-2xl mx-auto bg-white border rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:r?"Edit Process":"Add New Process"}),e.jsxs("form",{onSubmit:N(y),encType:"multipart/form-data",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-gray-700 font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",id:"title",...o("title",{required:"Title is required"}),className:"w-full p-2 border border-gray-300 rounded-lg"}),a.title&&e.jsx("p",{className:"text-red-500 text-sm",children:a.title.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-medium mb-2",children:"Description"}),e.jsx(E,{theme:"snow",value:p,onChange:g,className:"bg-white"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"photo",className:"block text-gray-700 font-medium mb-2",children:"Photo"}),e.jsx("input",{type:"file",id:"photo",...o("photo",{validate:t=>{var s;return!t[0]||((s=t[0])==null?void 0:s.type.startsWith("image/"))||"Only image files are allowed"}}),className:"w-full p-2 border border-gray-300 rounded-lg",onChange:t=>{t.target.files[0]&&x(URL.createObjectURL(t.target.files[0]))}}),a.photo&&e.jsx("p",{className:"text-red-500 text-sm",children:a.photo.message}),l&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:l,alt:"Preview",className:"w-1/4 h-auto rounded-lg"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"imgTitle",className:"block text-gray-700 font-medium mb-2",children:"Image Title"}),e.jsx("input",{type:"text",id:"imgTitle",...o("imgTitle",{required:"Image Title is required"}),className:"w-full p-2 border border-gray-300 rounded-lg"}),a.imgTitle&&e.jsx("p",{className:"text-red-500 text-sm",children:a.imgTitle.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"altName",className:"block text-gray-700 font-medium mb-2",children:"Alt Name"}),e.jsx("input",{type:"text",id:"altName",...o("altName",{required:"Alt Name is required"}),className:"w-full p-2 border border-gray-300 rounded-lg"}),a.altName&&e.jsx("p",{className:"text-red-500 text-sm",children:a.altName.message})]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{type:"submit",className:`w-full p-2 rounded-lg text-white ${n||c?"bg-gray-400":"bg-blue-500"}`,disabled:n||c,children:n||c?"Submitting...":r?"Update Process":"Add Process"})})]})]})};export{M as default};
