import{E as Y,s as _,r as l,j as t,b as p}from"./index-Bf0_iwmC.js";import{R as G}from"./quill.snow-N0L4fiYi.js";import{Q as J,B}from"./ReactToastify-C8h-yn_H.js";import"./clsx-B-dksMZM.js";const K=[{value:"Home",label:"Home"},{value:"About",label:"About"},{value:"Services",label:"Services"},{value:"Contact",label:"Contact"},{value:"Products",label:"Products"}],M={toolbar:[[{font:[]}],["bold","italic","underline","strike","blockquote"],[{header:[1,2,3,4,5,6,!1]}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],["link","image","video"],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],clipboard:{matchVisual:!1}},le=()=>{const{id:h}=Y(),F=_(),[u,v]=l.useState(""),[g,j]=l.useState(""),[x,N]=l.useState(""),[b,w]=l.useState([]),[o,y]=l.useState(null),[C,P]=l.useState("active"),[S,A]=l.useState([]),[k,I]=l.useState(),[R,$]=l.useState([]);l.useState("");const[i,E]=l.useState([]),[T,Z]=l.useState([]),[c,f]=l.useState([]),[m,D]=l.useState([]),U=async s=>{try{const a=(await p.get(`/api/banner/getCountBySection?section=${s}`,{withCredentials:!0})).data;$(Array.from({length:a},(n,d)=>d+1))}catch(e){console.error(e),$([1])}};l.useEffect(()=>{U(u)},[u]),l.useEffect(()=>{(async()=>{try{const a=(await p.get(`/api/banner/getBannerById?id=${h}`,{withCredentials:!0})).data.data;v(a.section),j(a.title),N(a.details),A(a.photo),y(a.video||null),P(a.status),I(a.priority),f(a.alt||[]),D(a.imgTitle||[])}catch(e){console.error("Error fetching banner:",e)}})()},[h]);const q=s=>{w(Array.from(s.target.files))},V=(s,e)=>{const a=[...c];a[e]=s.target.value,f(a)},L=(s,e)=>{const a=[...m];a[e]=s.target.value,D(a)},O=(s,e)=>{const a=[...i];a[e]=s.target.value,E(a)},z=(s,e)=>{s.preventDefault();const a=[...b];a.splice(e,1),w(a);const n=[...i];n.splice(e,1),E(n)};l.useEffect(()=>{o&&console.log("Video file selected:",o)},[o]);const H=s=>{const e=s.target.files[0];e&&e.type.startsWith("video/")?y(e):B.error("Please select a valid video file.")},Q=(s,e,a)=>{s.preventDefault(),p.delete(`/api/banner/image/${e}/${a}`,{withCredentials:!0}).then(n=>{const d=S.filter(W=>W!==e);A(d);const r=[...c];r.splice(a,1),f(r)}).catch(n=>{console.error(n)})},X=async s=>{s.preventDefault();try{const e=new FormData;e.append("section",u),e.append("title",g),e.append("details",x),e.append("status",C),e.append("priority",k);const a=[...c,...i],n=[...m,...T];b.forEach(r=>{e.append("photo",r)}),a.forEach(r=>{e.append("alt",r)}),n.forEach(r=>{e.append("imgTitle",r)}),o&&e.append("video",o);const d=`/api/banner/updateBanner?id=${h}`;await p.put(d,e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),F("/banner")}catch(e){e.response&&e.response.status===400?B.error(e.response.data.message):console.error("Error updating banner:",e)}};return t.jsxs("form",{onSubmit:X,className:"p-4",children:[t.jsx(J,{}),t.jsx("h1",{className:"text-xl font-bold font-serif text-gray-700 uppercase text-center",children:"Edit Banner"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"section",className:"block font-semibold mb-2",children:"Section"}),t.jsx("select",{id:"section",value:u,onChange:s=>v(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0,children:K.map((s,e)=>t.jsx("option",{value:s.value,children:s.label},e))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"title",className:"block font-semibold mb-2",children:"Title"}),t.jsx("input",{type:"text",id:"title",value:g,onChange:s=>j(s.target.value),className:"w-full p-2 border rounded focus:outline-none",required:!0})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("label",{htmlFor:"details",className:"block font-semibold mb-2",children:"Description"}),t.jsx(G,{value:x,onChange:N,modules:M,className:"quill"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block font-semibold mb-2",children:"Current Photos"}),t.jsx("div",{className:"flex flex-wrap gap-4",children:S.map((s,e)=>t.jsxs("div",{className:"relative w-56",children:[t.jsx("img",{src:`/api/image/download/${s}`,alt:c[e]||`Photo ${e+1}`,title:m[e]||`Image ${e+1}`,className:"w-56 h-32 object-cover"}),t.jsxs("label",{htmlFor:`alt-${e}`,className:"block mt-2",children:["Alternative Text :",t.jsx("input",{type:"text",id:`alt-${e}`,value:c[e],onChange:a=>V(a,e),className:"w-full p-2 border rounded focus:outline-none"})]}),t.jsxs("label",{htmlFor:`imgtitle-${e}`,className:"block mt-2",children:["Title Text :",t.jsx("input",{type:"text",id:`imgtitle-${e}`,value:m[e],onChange:a=>L(a,e),className:"w-full p-2 border rounded focus:outline-none"})]}),t.jsx("button",{onClick:a=>Q(a,s,e),className:"absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex justify-center items-center",children:t.jsx("span",{className:"text-xs",children:"X"})})]},e))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block font-semibold mb-2",children:"Add New Photos"}),t.jsx("input",{type:"file",onChange:q,multiple:!0,accept:"image/*",className:"p-2 border rounded"}),t.jsx("div",{className:"flex flex-wrap gap-4 mt-4",children:b.map((s,e)=>t.jsxs("div",{className:"relative w-56",children:[t.jsx("img",{src:URL.createObjectURL(s),alt:i[e]||`New Photo ${e+1}`,title:T[e]||`New Image ${e+1}`,className:"w-56 h-32 object-cover"}),t.jsxs("label",{htmlFor:`alt-new-${e}`,className:"block mt-2",children:["Alternative Text :",t.jsx("input",{type:"text",id:`alt-new-${e}`,value:i[e]||"",onChange:a=>O(a,e),className:"w-full p-2 border rounded focus:outline-none"})]}),t.jsx("button",{onClick:a=>z(a,e),className:`absolute top-4 right-2 bg-red-500 text-white rounded-md p-1 size-6 flex\r
                justify-center items-center`,children:t.jsx("span",{className:"text-xs",children:"X"})})]},e))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block font-semibold",children:"Upload Video"}),t.jsx("input",{type:"file",onChange:H,accept:"video/*",className:"p-2 border rounded"}),o&&o instanceof File&&t.jsxs("video",{controls:!0,className:"w-full mt-4",children:[t.jsx("source",{src:URL.createObjectURL(o),type:"video/mp4"}),"Your browser does not support the video tag."]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"priority",className:"block font-semibold mb-2",children:"Priority"}),t.jsx("select",{id:"priority",value:k,onChange:s=>I(Number(s.target.value)),className:"w-full p-2 border rounded focus:outline-none",required:!0,children:R.map(s=>t.jsx("option",{value:s,children:s},s))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"status",className:"block font-semibold mb-2",children:"Status"}),t.jsxs("select",{id:"status",value:C,onChange:s=>P(s.target.value),className:"w-full p-2 border rounded focus:outline-none",children:[t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"})]})]}),t.jsx("button",{type:"submit",className:"bg-blue-500 text-white py-2 px-4 rounded",children:"Update Banner"})]})};export{le as default};
